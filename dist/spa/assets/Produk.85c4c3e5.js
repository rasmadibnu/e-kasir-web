import{r as g,a as v,j as ce,z as be,C as pe,t as ke,h as z,c as ye,a8 as we,y as Ve,_ as Ce,O as Se,P as H,Q as w,X as Fe,T as a,S as n,Y as De,$ as I,Z as D,V as Q,W as J,D as O,R as S,ap as ze,av as ee,aI as te,U as Ne,aq as le}from"./index.3d2cacac.js";import{u as Qe,e as _e,b as Pe,d as $e,f as Ie,j as Ue,c as je,g as ae,Q as E,a as Te}from"./QForm.2dfbb616.js";import{d as qe,Q as Ae,h as Oe,a as Ee,b as ie,c as xe,e as se}from"./moment.2e905c78.js";import{p as Be,j as ne,k as Re,l as Ye,Q as x,i as oe,m as Me,n as re,C as ue}from"./ClosePopup.59a25c0b.js";import{_ as Le,Q as de,b as B}from"./VxIcon.2962a322.js";import{Q as fe}from"./QImg.15f1ced3.js";function _(e,t,f,F){const d=[];return e.forEach(c=>{F(c)===!0?d.push(c):t.push({failedPropValidation:f,file:c})}),d}function R(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),pe(e)}const Ke={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},We=["rejected"];function Xe({editable:e,dnd:t,getFileInput:f,addFilesToQueue:F}){const{props:d,emit:c,proxy:p}=ce(),V=g(null),l=v(()=>d.accept!==void 0?d.accept.split(",").map(i=>(i=i.trim(),i==="*"?"*/":(i.endsWith("/*")&&(i=i.slice(0,i.length-1)),i.toUpperCase()))):null),N=v(()=>parseInt(d.maxFiles,10)),U=v(()=>parseInt(d.maxTotalSize,10));function j(i){if(e.value)if(i!==Object(i)&&(i={target:null}),i.target!==null&&i.target.matches('input[type="file"]')===!0)i.clientX===0&&i.clientY===0&&be(i);else{const k=f();k&&k!==i.target&&k.click(i)}}function T(i){e.value&&i&&F(null,i)}function Y(i,k,P,$){let o=Array.from(k||i.target.files);const b=[],C=()=>{b.length!==0&&c("rejected",b)};if(d.accept!==void 0&&l.value.indexOf("*/")===-1&&(o=_(o,b,"accept",r=>l.value.some(m=>r.type.toUpperCase().startsWith(m)||r.name.toUpperCase().endsWith(m))),o.length===0))return C();if(d.maxFileSize!==void 0){const r=parseInt(d.maxFileSize,10);if(o=_(o,b,"max-file-size",m=>m.size<=r),o.length===0)return C()}if(d.multiple!==!0&&o.length!==0&&(o=[o[0]]),o.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),$===!0){const r=P.map(m=>m.__key);o=_(o,b,"duplicate",m=>r.includes(m.__key)===!1)}if(o.length===0)return C();if(d.maxTotalSize!==void 0){let r=$===!0?P.reduce((m,K)=>m+K.size,0):0;if(o=_(o,b,"max-total-size",m=>(r+=m.size,r<=U.value)),o.length===0)return C()}if(typeof d.filter=="function"){const r=d.filter(o);o=_(o,b,"filter",m=>r.includes(m))}if(d.maxFiles!==void 0){let r=$===!0?P.length:0;if(o=_(o,b,"max-files",()=>(r++,r<=N.value)),o.length===0)return C()}if(C(),o.length!==0)return o}function M(i){R(i),t.value!==!0&&(t.value=!0)}function u(i){pe(i),(i.relatedTarget!==null||ke.is.safari!==!0?i.relatedTarget!==V.value:document.elementsFromPoint(i.clientX,i.clientY).includes(V.value)===!1)===!0&&(t.value=!1)}function q(i){R(i);const k=i.dataTransfer.files;k.length!==0&&F(null,k),t.value=!1}function L(i){if(t.value===!0)return z("div",{ref:V,class:`q-${i}__dnd absolute-full`,onDragenter:R,onDragover:R,onDragleave:u,onDrop:q})}return Object.assign(p,{pickFiles:j,addFiles:T}),{pickFiles:j,addFiles:T,onDragover:M,onDragleave:u,processFiles:Y,getDndNode:L,maxFilesNumber:N,maxTotalSizeNumber:U}}var me=ye({name:"QFile",inheritAttrs:!1,props:{...Qe,..._e,...Ke,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Pe,...We],setup(e,{slots:t,emit:f,attrs:F}){const{proxy:d}=ce(),c=$e(),p=g(null),V=g(!1),l=Ie(e),{pickFiles:N,onDragover:U,onDragleave:j,processFiles:T,getDndNode:Y}=Xe({editable:c.editable,dnd:V,getFileInput:Z,addFilesToQueue:G}),M=Ue(e),u=v(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),q=v(()=>ae(u.value)),L=v(()=>u.value.map(s=>s.name).join(", ")),i=v(()=>Be(u.value.reduce((s,h)=>s+h.size,0))),k=v(()=>({totalSize:i.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),P=v(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:l.value,...F,id:c.targetUid.value,disabled:c.editable.value!==!0})),$=v(()=>"q-file q-field--auto-height"+(V.value===!0?" q-file--dnd":"")),o=v(()=>e.multiple===!0&&e.append===!0);function b(s){const h=u.value.slice();h.splice(s,1),r(h)}function C(s){const h=u.value.indexOf(s);h>-1&&b(h)}function r(s){f("update:modelValue",e.multiple===!0?s:s[0])}function m(s){s.keyCode===13&&Ve(s)}function K(s){(s.keyCode===13||s.keyCode===32)&&N(s)}function Z(){return p.value}function G(s,h){const y=T(s,h,u.value,o.value),W=Z();W!=null&&(W.value=""),y!==void 0&&((e.multiple===!0?e.modelValue&&y.every(ve=>u.value.includes(ve)):e.modelValue===y[0])||r(o.value===!0?u.value.concat(y):y))}function A(){return[z("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ge(){if(t.file!==void 0)return u.value.length===0?A():u.value.map((h,y)=>t.file({index:y,file:h,ref:this}));if(t.selected!==void 0)return u.value.length===0?A():t.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?A():u.value.map((h,y)=>z(qe,{key:"file-"+y,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{b(y)}},()=>z("span",{class:"ellipsis",textContent:h.name})));const s=e.displayValue!==void 0?e.displayValue:L.value;return s.length!==0?[z("div",{class:e.inputClass,style:e.inputStyle,textContent:s})]:A()}function he(){const s={ref:p,...P.value,...M.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:G};return e.multiple===!0&&(s.multiple=!0),z("input",s)}return Object.assign(c,{fieldClass:$,emitValue:r,hasValue:q,inputRef:p,innerValue:u,floatingLabel:v(()=>q.value===!0||ae(e.displayValue)),computedCounter:v(()=>{if(e.counterLabel!==void 0)return e.counterLabel(k.value);const s=e.maxFiles;return`${u.value.length}${s!==void 0?" / "+s:""} (${i.value})`}),getControlChild:()=>Y("file"),getControl:()=>{const s={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(s,{onDragover:U,onDragleave:j,onKeydown:m,onKeyup:K}),z("div",s,[he()].concat(ge()))}}),Object.assign(d,{removeAtIndex:b,removeFile:C,getNativeElement:()=>p.value}),we(d,"nativeEl",()=>p.value),je(c)}}),Ze="/assets/undraw_images.58b3e46f.svg";const Ge=[{name:"index",label:"#",align:"center"},{name:"Name",label:"Nama",align:"left",field:"name",sortable:!0},{name:"Kategori",label:"Kategori",align:"left",field:e=>{var t;return(t=e.kategori)==null?void 0:t.name},sortable:!0},{name:"Stok",label:"Stok",align:"left",field:e=>{var t;return(t=e.stok)==null?void 0:t.stok},sortable:!0},{name:"Supplier",label:"Supplier",align:"left",field:e=>{var t;return(t=e.supplier)==null?void 0:t.name},sortable:!0},{name:"Created",label:"Created By",align:"left",field:e=>{var t;return(t=e.user_create)==null?void 0:t.name},sortable:!0},{name:"Updated",label:"Updated At",align:"left",field:e=>Oe(e.updated_at).format("YYYY-MM-DD hh:mm:ss"),sortable:!0},{name:"action",label:"Action",align:"right"}],X={name:null,deskripsi:"",kategori_id:null,supplier_id:null,file:null,stok:null},He=Se({props:["user"],components:{VxIcon:Le},setup(){return{columns:Ge,rows:g([]),kategori:g([]),supplier:g([]),loading:g(!1),search:g(""),is_edit:g(!1),confirm:g(!1),src:g(""),form_dialog:g(!1),id:g(""),form:g(structuredClone(X))}},mounted(){this.getData(),this.getkategori(),this.getSupplier()},methods:{getData(){this.loading=!0,this.$api.get("/produk").then(e=>{this.rows=e.data.data,this.loading=!1}).catch(e=>{console.log(e)})},getkategori(){this.$api.get("/kategori").then(e=>{this.kategori=e.data.data.map(t=>({label:t.name,value:t.id}))}).catch(e=>{console.log(e)})},getSupplier(){this.$api.get("/suppliers").then(e=>{this.supplier=e.data.data.map(t=>({label:t.name,value:t.id}))}).catch(e=>{console.log(e)})},onFilePicked(e){this.src=e?URL.createObjectURL(e):""},openDialog(e){e?(this.is_edit=!0,this.id=e.id,e.image&&(this.src=this.$urlapi+"/"+e.image),this.form={...e}):(this.form={...X},this.is_edit=!1),this.form_dialog=!0},closeDialog(){this.form={...X},this.form_dialog=!1,this.loading=!1},submit(){this.loading=!0;var e=new FormData;for(const f in this.form)this.form.hasOwnProperty(f)&&e.append(f,this.form[f]);const t={headers:{"Content-Type":"multipart/form-data"}};this.is_edit?(e.append("updated_by",this.user.id),this.$api.put("/produk/"+this.id,e,t).then(f=>{this.$q.notify({message:"Produk successfully updated",color:"positive"}),this.closeDialog(),this.getData()}).catch(f=>{this.closeDialog(),console.log(f)})):(e.append("created_by",this.user.id),this.$api.post("/produk",e,t).then(f=>{this.$q.notify({message:"Produk successfully created",color:"positive"}),this.closeDialog(),this.getData()}).catch(f=>{this.closeDialog(),console.log(f)}))},confirmDelete(e){this.id=e,this.confirm=!0},deleteData(){this.$api.delete("/produk/"+this.id).then(e=>{this.$q.notify({message:"Produk successfully deleted",color:"positive"}),this.getData(),this.confirm=!1}).catch(e=>{console.log(e),this.confirm=!1})}}}),Je=I("div",{class:"tw-text-xl tw-font-semibold"},"Produk",-1),et={class:"tw-flex tw-justify-between tw-w-full"},tt={class:"text-h6"},lt={class:"text-h6 text-negative tw-flex tw-items-center"};function at(e,t,f,F,d,c){const p=H("vx-icon"),V=H("VxIcon");return w(),Fe(De,null,[a(Ae,{class:"tw-p-4 tw-space-y-6"},{default:n(()=>[Je,a(Ee,{color:"primary",columns:e.columns,rows:e.rows,loading:e.loading,filter:e.search,pagination:{rowsPerPage:10},flat:""},{top:n(()=>[I("div",et,[a(D,{outline:"","no-caps":"",color:"primary",onClick:t[0]||(t[0]=l=>e.openDialog(null))},{default:n(()=>[a(p,{iconName:"AddCircle",class:"tw-mr-2",size:20}),Q(" Create New ")]),_:1}),a(E,{dense:"",placeholder:"Search...",modelValue:e.search,"onUpdate:modelValue":t[1]||(t[1]=l=>e.search=l),filled:""},{prepend:n(()=>[a(p,{iconName:"SearchStatus",size:20})]),_:1},8,["modelValue"])])]),"body-cell-index":n(l=>[a(ie,{props:l},{default:n(()=>[Q(J(l.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-action":n(l=>[a(ie,{props:l},{default:n(()=>[a(D,{flat:"",dense:"",size:"sm",color:"primary"},{default:n(()=>[a(p,{iconName:"More",size:18}),a(Re,{"auto-close":"",class:"tw-shadow-none tw-border"},{default:n(()=>[a(Ye,{style:{"min-width":"100px"}},{default:n(()=>[O((w(),S(oe,{clickable:"",class:"text-primary",onClick:N=>e.openDialog(l.row)},{default:n(()=>[a(x,{avatar:""},{default:n(()=>[a(p,{iconName:"Edit",size:20})]),_:1}),a(x,null,{default:n(()=>[Q("Edit")]),_:1})]),_:2},1032,["onClick"])),[[le]]),a(Me),O((w(),S(oe,{clickable:"",class:"text-negative",onClick:N=>e.confirmDelete(l.row.id)},{default:n(()=>[a(x,{avatar:""},{default:n(()=>[a(p,{iconName:"Trash",size:20})]),_:1}),a(x,null,{default:n(()=>[Q("Delete")]),_:1})]),_:2},1032,["onClick"])),[[le]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","filter"])]),_:1}),a(ne,{modelValue:e.form_dialog,"onUpdate:modelValue":t[10]||(t[10]=l=>e.form_dialog=l)},{default:n(()=>[a(de,{style:{"min-width":"600px"}},{default:n(()=>[a(B,{class:"row items-center"},{default:n(()=>[I("div",tt,J(e.is_edit?"Edit":"Create")+" Produk",1),a(xe),O((w(),S(D,{flat:"",round:"",dense:""},{default:n(()=>[a(p,{iconName:"CloseCircle",size:20})]),_:1})),[[ue]])]),_:1}),a(Te,{onSubmit:ze(e.submit,["prevent"])},{default:n(()=>[a(B,{class:"tw-grid tw-grid-cols-6 tw-gap-x-4 tw-gap-y-2"},{default:n(()=>[I("div",{class:"tw-col-span-6 tw-w-full tw-border tw-mb-2 tw-rounded tw-py-4 tw-cursor-pointer",onClick:t[2]||(t[2]=l=>e.$refs.file.pickFiles())},[e.src?(w(),S(fe,{key:1,src:e.src,style:{"min-height":"200px"},fit:"fit"},null,8,["src"])):(w(),S(fe,{key:0,src:Ze,style:{height:"200px"},fit:"contain"}))]),e.is_edit?(w(),S(me,{key:1,filled:"",label:"Image",accept:"image/jpeg,.png",ref:"file",class:"tw-col-span-6",modelValue:e.form.file,"onUpdate:modelValue":[t[4]||(t[4]=l=>e.form.file=l),e.onFilePicked],clearable:"",hint:e.form.image.split("\\")[1]},{append:n(()=>[a(ee,{name:"attachment"})]),_:1},8,["modelValue","onUpdate:modelValue","hint"])):(w(),S(me,{key:0,filled:"",label:"Image",accept:"image/jpeg,.png",ref:"file",class:"tw-col-span-6",modelValue:e.form.file,"onUpdate:modelValue":[t[3]||(t[3]=l=>e.form.file=l),e.onFilePicked],rules:[l=>!!l||"This field is required"],clearable:""},{append:n(()=>[a(ee,{name:"attachment"})]),_:1},8,["modelValue","rules","onUpdate:modelValue"])),a(E,{modelValue:e.form.name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.form.name=l),filled:"",label:"Nama",class:"tw-col-span-3",rules:[l=>!!l||"This field is required"]},null,8,["modelValue","rules"]),a(E,{modelValue:e.form.deskripsi,"onUpdate:modelValue":t[6]||(t[6]=l=>e.form.deskripsi=l),filled:"",label:"Deskripsi",class:"tw-col-span-3"},null,8,["modelValue"]),a(se,{options:e.kategori,"map-options":"","emit-value":"",modelValue:e.form.kategori_id,"onUpdate:modelValue":t[7]||(t[7]=l=>e.form.kategori_id=l),filled:"",label:"Kategori",rules:[l=>!!l||"This field is required"],class:te(e.is_edit?"tw-col-span-3":"tw-col-span-2")},null,8,["options","modelValue","rules","class"]),a(se,{options:e.supplier,"map-options":"","emit-value":"",modelValue:e.form.supplier_id,"onUpdate:modelValue":t[8]||(t[8]=l=>e.form.supplier_id=l),filled:"",label:"Supplier",rules:[l=>!!l||"This field is required"],class:te(e.is_edit?"tw-col-span-3":"tw-col-span-2")},null,8,["options","modelValue","rules","class"]),e.is_edit?Ne("",!0):(w(),S(E,{key:2,modelValue:e.form.stok,"onUpdate:modelValue":t[9]||(t[9]=l=>e.form.stok=l),filled:"",label:"Stok",mask:"#","reverse-fill-mask":"",rules:[l=>!!l||"This field is required"],class:"tw-col-span-2"},null,8,["modelValue","rules"]))]),_:1}),a(re,{align:"right"},{default:n(()=>[a(D,{label:"Cancel","no-caps":"",flat:"",onClick:e.closeDialog,color:"negative"},null,8,["onClick"]),a(D,{label:"Submit",loading:e.loading,type:"submit","no-caps":"",flat:"",color:"primary"},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"]),a(ne,{modelValue:e.confirm,"onUpdate:modelValue":t[11]||(t[11]=l=>e.confirm=l)},{default:n(()=>[a(de,null,{default:n(()=>[a(B,null,{default:n(()=>[I("div",lt,[a(V,{iconName:"Warning2",class:"tw-mr-2",size:22}),Q(" Confirmation ")])]),_:1}),a(B,{class:"q-pt-none"},{default:n(()=>[Q(" Are you sure want to delete this data? ")]),_:1}),a(re,{align:"right"},{default:n(()=>[O(a(D,{flat:"",label:"Cancel","no-caps":""},null,512),[[ue]]),a(D,{flat:"",label:"Yes",color:"negative","no-caps":"",onClick:e.deleteData},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var dt=Ce(He,[["render",at]]);export{dt as default};
