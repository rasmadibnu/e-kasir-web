import{r as g,a as v,j as ce,u as be,y as pe,m as ke,h as N,c as ye,a8 as we,t as Ve,_ as Ce,O as Se,P as ee,Q as w,X as Fe,T as a,S as s,Y as De,$ as j,Z as D,V as Q,W as le,B as U,R as V,cf as Qe,ck as te,U as Ne,aN as ze,ci as H}from"./index.8a61695e.js";import{u as Pe,Q as T}from"./QInput.d7cd4427.js";import{Q as ae}from"./QTd.55ae123c.js";import{r as _e,j as ie,k as $e,l as Ie,Q as P,i as X,m as se}from"./QDialog.a3d2e9f2.js";import{b as Ue,Q as Te,h as je,a as qe,c as oe}from"./moment.ef2cf31d.js";import{Q as Ae}from"./QSpace.d31d5e13.js";import{Q as ne,a as B}from"./QCard.b11d0a6e.js";import{Q as re}from"./QImg.da1eb860.js";import{a as Oe,e as xe,b as Ee,d as Be,f as Re,c as Me,g as ue}from"./use-key-composition.b096f1b1.js";import{Q as de,C as me}from"./ClosePopup.651837a9.js";import{Q as Ye}from"./QForm.868096f5.js";import{_ as Le}from"./VxIcon.632b9159.js";function _(e,l,m,F){const d=[];return e.forEach(c=>{F(c)===!0?d.push(c):l.push({failedPropValidation:m,file:c})}),d}function R(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),pe(e)}const Ke={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},We=["rejected"];function He({editable:e,dnd:l,getFileInput:m,addFilesToQueue:F}){const{props:d,emit:c,proxy:p}=ce(),C=g(null),t=v(()=>d.accept!==void 0?d.accept.split(",").map(i=>(i=i.trim(),i==="*"?"*/":(i.endsWith("/*")&&(i=i.slice(0,i.length-1)),i.toUpperCase()))):null),z=v(()=>parseInt(d.maxFiles,10)),q=v(()=>parseInt(d.maxTotalSize,10));function A(i){if(e.value)if(i!==Object(i)&&(i={target:null}),i.target!==null&&i.target.matches('input[type="file"]')===!0)i.clientX===0&&i.clientY===0&&be(i);else{const k=m();k&&k!==i.target&&k.click(i)}}function O(i){e.value&&i&&F(null,i)}function M(i,k,$,I){let n=Array.from(k||i.target.files);const b=[],S=()=>{b.length!==0&&c("rejected",b)};if(d.accept!==void 0&&t.value.indexOf("*/")===-1&&(n=_(n,b,"accept",r=>t.value.some(f=>r.type.toUpperCase().startsWith(f)||r.name.toUpperCase().endsWith(f))),n.length===0))return S();if(d.maxFileSize!==void 0){const r=parseInt(d.maxFileSize,10);if(n=_(n,b,"max-file-size",f=>f.size<=r),n.length===0)return S()}if(d.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),I===!0){const r=$.map(f=>f.__key);n=_(n,b,"duplicate",f=>r.includes(f.__key)===!1)}if(n.length===0)return S();if(d.maxTotalSize!==void 0){let r=I===!0?$.reduce((f,K)=>f+K.size,0):0;if(n=_(n,b,"max-total-size",f=>(r+=f.size,r<=q.value)),n.length===0)return S()}if(typeof d.filter=="function"){const r=d.filter(n);n=_(n,b,"filter",f=>r.includes(f))}if(d.maxFiles!==void 0){let r=I===!0?$.length:0;if(n=_(n,b,"max-files",()=>(r++,r<=z.value)),n.length===0)return S()}if(S(),n.length!==0)return n}function Y(i){R(i),l.value!==!0&&(l.value=!0)}function u(i){pe(i),(i.relatedTarget!==null||ke.is.safari!==!0?i.relatedTarget!==C.value:document.elementsFromPoint(i.clientX,i.clientY).includes(C.value)===!1)===!0&&(l.value=!1)}function x(i){R(i);const k=i.dataTransfer.files;k.length!==0&&F(null,k),l.value=!1}function L(i){if(l.value===!0)return N("div",{ref:C,class:`q-${i}__dnd absolute-full`,onDragenter:R,onDragover:R,onDragleave:u,onDrop:x})}return Object.assign(p,{pickFiles:A,addFiles:O}),{pickFiles:A,addFiles:O,onDragover:Y,onDragleave:u,processFiles:M,getDndNode:L,maxFilesNumber:z,maxTotalSizeNumber:q}}var fe=ye({name:"QFile",inheritAttrs:!1,props:{...Oe,...xe,...Ke,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ee,...We],setup(e,{slots:l,emit:m,attrs:F}){const{proxy:d}=ce(),c=Be(),p=g(null),C=g(!1),t=Re(e),{pickFiles:z,onDragover:q,onDragleave:A,processFiles:O,getDndNode:M}=He({editable:c.editable,dnd:C,getFileInput:G,addFilesToQueue:J}),Y=Pe(e),u=v(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),x=v(()=>ue(u.value)),L=v(()=>u.value.map(o=>o.name).join(", ")),i=v(()=>_e(u.value.reduce((o,h)=>o+h.size,0))),k=v(()=>({totalSize:i.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),$=v(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:t.value,...F,id:c.targetUid.value,disabled:c.editable.value!==!0})),I=v(()=>"q-file q-field--auto-height"+(C.value===!0?" q-file--dnd":"")),n=v(()=>e.multiple===!0&&e.append===!0);function b(o){const h=u.value.slice();h.splice(o,1),r(h)}function S(o){const h=u.value.indexOf(o);h>-1&&b(h)}function r(o){m("update:modelValue",e.multiple===!0?o:o[0])}function f(o){o.keyCode===13&&Ve(o)}function K(o){(o.keyCode===13||o.keyCode===32)&&z(o)}function G(){return p.value}function J(o,h){const y=O(o,h,u.value,n.value),W=G();W!=null&&(W.value=""),y!==void 0&&((e.multiple===!0?e.modelValue&&y.every(ve=>u.value.includes(ve)):e.modelValue===y[0])||r(n.value===!0?u.value.concat(y):y))}function E(){return[N("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ge(){if(l.file!==void 0)return u.value.length===0?E():u.value.map((h,y)=>l.file({index:y,file:h,ref:this}));if(l.selected!==void 0)return u.value.length===0?E():l.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?E():u.value.map((h,y)=>N(Ue,{key:"file-"+y,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{b(y)}},()=>N("span",{class:"ellipsis",textContent:h.name})));const o=e.displayValue!==void 0?e.displayValue:L.value;return o.length!==0?[N("div",{class:e.inputClass,style:e.inputStyle,textContent:o})]:E()}function he(){const o={ref:p,...$.value,...Y.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:J};return e.multiple===!0&&(o.multiple=!0),N("input",o)}return Object.assign(c,{fieldClass:I,emitValue:r,hasValue:x,inputRef:p,innerValue:u,floatingLabel:v(()=>x.value===!0||ue(e.displayValue)),computedCounter:v(()=>{if(e.counterLabel!==void 0)return e.counterLabel(k.value);const o=e.maxFiles;return`${u.value.length}${o!==void 0?" / "+o:""} (${i.value})`}),getControlChild:()=>M("file"),getControl:()=>{const o={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(o,{onDragover:q,onDragleave:A,onKeydown:f,onKeyup:K}),N("div",o,[he()].concat(ge()))}}),Object.assign(d,{removeAtIndex:b,removeFile:S,getNativeElement:()=>p.value}),we(d,"nativeEl",()=>p.value),Me(c)}}),Xe="/assets/undraw_images.58b3e46f.svg";const Ze=[{name:"index",label:"#",align:"center"},{name:"Name",label:"Nama",align:"left",field:"name",sortable:!0},{name:"Kategori",label:"Kategori",align:"left",field:e=>{var l;return(l=e.kategori)==null?void 0:l.name},sortable:!0},{name:"Harga",label:"Harga",align:"left",field:"harga_rp",sortable:!0},{name:"Stok",label:"Stok",align:"left",field:e=>{var l;return(l=e.stok)==null?void 0:l.stok},sortable:!0},{name:"Supplier",label:"Supplier",align:"left",field:e=>{var l;return(l=e.supplier)==null?void 0:l.name},sortable:!0},{name:"Created",label:"Created By",align:"left",field:e=>{var l;return(l=e.user_create)==null?void 0:l.name},sortable:!0},{name:"Updated",label:"Updated At",align:"left",field:e=>je(e.updated_at).format("YYYY-MM-DD hh:mm:ss"),sortable:!0},{name:"action",label:"Action",align:"right"}],Z={name:null,deskripsi:"",kategori_id:null,supplier_id:null,harga:null,file:null,stok:null},Ge=Se({props:["user"],components:{VxIcon:Le},setup(){return{columns:Ze,rows:g([]),kategori:g([]),supplier:g([]),loading:g(!1),search:g(""),is_edit:g(!1),confirm:g(!1),src:g(""),form_dialog:g(!1),id:g(""),form:g(structuredClone(Z))}},mounted(){this.getData(),this.getkategori(),this.getSupplier()},methods:{getData(){this.loading=!0,this.$api.get("/produk").then(e=>{this.rows=e.data.data,this.loading=!1}).catch(e=>{console.log(e)})},getkategori(){this.$api.get("/kategori").then(e=>{this.kategori=e.data.data.map(l=>({label:l.name,value:l.id}))}).catch(e=>{console.log(e)})},getSupplier(){this.$api.get("/suppliers").then(e=>{this.supplier=e.data.data.map(l=>({label:l.name,value:l.id}))}).catch(e=>{console.log(e)})},onFilePicked(e){this.src=e?URL.createObjectURL(e):""},openDialog(e){e?(this.is_edit=!0,this.id=e.id,e.image&&(this.src=this.$urlapi+"/"+e.image),this.form={...e}):(this.src=null,this.form={...Z},this.is_edit=!1),this.form_dialog=!0},closeDialog(){this.form={...Z},this.form_dialog=!1,this.loading=!1},submit(){this.loading=!0;var e=new FormData;for(const m in this.form)this.form.hasOwnProperty(m)&&e.append(m,this.form[m]);const l={headers:{"Content-Type":"multipart/form-data"}};this.is_edit?(e.append("updated_by",this.user.id),this.$api.put("/produk/"+this.id,e,l).then(m=>{this.$q.notify({message:"Produk successfully updated",color:"positive"}),this.closeDialog(),this.getData()}).catch(m=>{this.closeDialog(),console.log(m)})):(e.append("created_by",this.user.id),this.$api.post("/produk",e,l).then(m=>{this.$q.notify({message:"Produk successfully created",color:"positive"}),this.closeDialog(),this.getData()}).catch(m=>{this.closeDialog(),console.log(m)}))},confirmDelete(e){this.id=e,this.confirm=!0},deleteData(){this.$api.delete("/produk/"+this.id).then(e=>{this.$q.notify({message:"Produk successfully deleted",color:"positive"}),this.getData(),this.confirm=!1}).catch(e=>{console.log(e),this.confirm=!1})}}}),Je=j("div",{class:"tw-text-xl tw-font-semibold"},"Produk",-1),el={class:"tw-flex tw-justify-between tw-w-full"},ll={class:"text-h6"},tl={class:"text-h6 text-negative tw-flex tw-items-center"};function al(e,l,m,F,d,c){const p=ee("vx-icon"),C=ee("VxIcon");return w(),Fe(De,null,[a(Te,{class:"tw-p-4 tw-space-y-6"},{default:s(()=>[Je,a(qe,{color:"primary",columns:e.columns,rows:e.rows,loading:e.loading,filter:e.search,pagination:{rowsPerPage:10},flat:""},{top:s(()=>[j("div",el,[a(D,{outline:"","no-caps":"",color:"primary",onClick:l[0]||(l[0]=t=>e.openDialog(null))},{default:s(()=>[a(p,{iconName:"AddCircle",class:"tw-mr-2",size:20}),Q(" Create New ")]),_:1}),a(T,{dense:"",placeholder:"Search...",modelValue:e.search,"onUpdate:modelValue":l[1]||(l[1]=t=>e.search=t),filled:""},{prepend:s(()=>[a(p,{iconName:"SearchStatus",size:20})]),_:1},8,["modelValue"])])]),"body-cell-index":s(t=>[a(ae,{props:t},{default:s(()=>[Q(le(t.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-action":s(t=>[a(ae,{props:t},{default:s(()=>[a(D,{flat:"",dense:"",size:"sm",color:"primary"},{default:s(()=>[a(p,{iconName:"More",size:18}),a($e,{"auto-close":"",class:"tw-shadow-none tw-border"},{default:s(()=>[a(Ie,{style:{"min-width":"100px"}},{default:s(()=>[U((w(),V(X,{clickable:"",class:"text-primary",to:{name:"ProdukDetail",params:{id:t.row.id,from:"Produk"}}},{default:s(()=>[a(P,{avatar:""},{default:s(()=>[a(p,{iconName:"Eye",size:20})]),_:1}),a(P,null,{default:s(()=>[Q("View")]),_:1})]),_:2},1032,["to"])),[[H]]),a(se),U((w(),V(X,{clickable:"",class:"text-primary",onClick:z=>e.openDialog(t.row)},{default:s(()=>[a(P,{avatar:""},{default:s(()=>[a(p,{iconName:"Edit",size:20})]),_:1}),a(P,null,{default:s(()=>[Q("Edit")]),_:1})]),_:2},1032,["onClick"])),[[H]]),a(se),U((w(),V(X,{clickable:"",class:"text-negative",onClick:z=>e.confirmDelete(t.row.id)},{default:s(()=>[a(P,{avatar:""},{default:s(()=>[a(p,{iconName:"Trash",size:20})]),_:1}),a(P,null,{default:s(()=>[Q("Delete")]),_:1})]),_:2},1032,["onClick"])),[[H]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","loading","filter"])]),_:1}),a(ie,{modelValue:e.form_dialog,"onUpdate:modelValue":l[11]||(l[11]=t=>e.form_dialog=t)},{default:s(()=>[a(ne,{style:{"min-width":"600px"}},{default:s(()=>[a(B,{class:"row items-center"},{default:s(()=>[j("div",ll,le(e.is_edit?"Edit":"Create")+" Produk",1),a(Ae),U((w(),V(D,{flat:"",round:"",dense:""},{default:s(()=>[a(p,{iconName:"CloseCircle",size:20})]),_:1})),[[me]])]),_:1}),a(Ye,{onSubmit:Qe(e.submit,["prevent"])},{default:s(()=>[a(B,{class:"tw-grid tw-grid-cols-6 tw-gap-x-4 tw-gap-y-2"},{default:s(()=>[j("div",{class:"tw-col-span-6 tw-w-full tw-border tw-mb-2 tw-rounded tw-py-4 tw-cursor-pointer",onClick:l[2]||(l[2]=t=>e.$refs.file.pickFiles())},[e.src?(w(),V(re,{key:1,src:e.src,style:{"min-height":"200px"},fit:"fit"},null,8,["src"])):(w(),V(re,{key:0,src:Xe,style:{height:"200px"},fit:"contain"}))]),e.is_edit?(w(),V(fe,{key:1,filled:"",label:"Image",accept:"image/jpeg,.png",ref:"file",class:"tw-col-span-6",modelValue:e.form.file,"onUpdate:modelValue":[l[4]||(l[4]=t=>e.form.file=t),e.onFilePicked],clearable:"",hint:e.form.image},{append:s(()=>[a(te,{name:"attachment"})]),_:1},8,["modelValue","onUpdate:modelValue","hint"])):(w(),V(fe,{key:0,filled:"",label:"Image",accept:"image/jpeg,.png",ref:"file",class:"tw-col-span-6",modelValue:e.form.file,"onUpdate:modelValue":[l[3]||(l[3]=t=>e.form.file=t),e.onFilePicked],rules:[t=>!!t||"This field is required"],clearable:""},{append:s(()=>[a(te,{name:"attachment"})]),_:1},8,["modelValue","rules","onUpdate:modelValue"])),a(T,{modelValue:e.form.name,"onUpdate:modelValue":l[5]||(l[5]=t=>e.form.name=t),filled:"",label:"Nama",class:"tw-col-span-3",rules:[t=>!!t||"This field is required"]},null,8,["modelValue","rules"]),a(T,{modelValue:e.form.deskripsi,"onUpdate:modelValue":l[6]||(l[6]=t=>e.form.deskripsi=t),filled:"",label:"Deskripsi",class:"tw-col-span-3"},null,8,["modelValue"]),a(oe,{options:e.kategori,"map-options":"","emit-value":"",modelValue:e.form.kategori_id,"onUpdate:modelValue":l[7]||(l[7]=t=>e.form.kategori_id=t),filled:"",label:"Kategori",rules:[t=>!!t||"This field is required"],class:"tw-col-span-3"},null,8,["options","modelValue","rules"]),a(oe,{options:e.supplier,"map-options":"","emit-value":"",modelValue:e.form.supplier_id,"onUpdate:modelValue":l[8]||(l[8]=t=>e.form.supplier_id=t),filled:"",label:"Supplier",rules:[t=>!!t||"This field is required"],class:"tw-col-span-3"},null,8,["options","modelValue","rules"]),e.is_edit?Ne("",!0):(w(),V(T,{key:2,modelValue:e.form.stok,"onUpdate:modelValue":l[9]||(l[9]=t=>e.form.stok=t),filled:"",label:"Stok",mask:"#","reverse-fill-mask":"",rules:[t=>!!t||"This field is required"],class:"tw-col-span-3"},null,8,["modelValue","rules"])),a(T,{modelValue:e.form.harga,"onUpdate:modelValue":l[10]||(l[10]=t=>e.form.harga=t),modelModifiers:{number:!0},filled:"",label:"Harga",prefix:"Rp.",mask:"###.###.###.###","reverse-fill-mask":"","unmasked-value":"",rules:[t=>!!t||"This field is required"],class:ze(e.is_edit?"tw-col-span-6":"tw-col-span-3")},null,8,["modelValue","rules","class"])]),_:1}),a(de,{align:"right"},{default:s(()=>[a(D,{label:"Cancel","no-caps":"",flat:"",onClick:e.closeDialog,color:"negative"},null,8,["onClick"]),a(D,{label:"Submit",loading:e.loading,type:"submit","no-caps":"",flat:"",color:"primary"},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"]),a(ie,{modelValue:e.confirm,"onUpdate:modelValue":l[12]||(l[12]=t=>e.confirm=t)},{default:s(()=>[a(ne,null,{default:s(()=>[a(B,null,{default:s(()=>[j("div",tl,[a(C,{iconName:"Warning2",class:"tw-mr-2",size:22}),Q(" Confirmation ")])]),_:1}),a(B,{class:"q-pt-none"},{default:s(()=>[Q(" Are you sure want to delete this data? ")]),_:1}),a(de,{align:"right"},{default:s(()=>[U(a(D,{flat:"",label:"Cancel","no-caps":""},null,512),[[me]]),a(D,{flat:"",label:"Yes",color:"negative","no-caps":"",onClick:e.deleteData},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var hl=Ce(Ge,[["render",al]]);export{hl as default};
